"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6295],{4852:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>d});var r=n(9231);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),m=c(n),d=o,f=m["".concat(l,".").concat(d)]||m[d]||u[d]||a;return n?r.createElement(f,i(i({ref:t},p),{},{components:n})):r.createElement(f,i({ref:t},p))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var c=2;c<a;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8201:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>s,toc:()=>c});var r=n(7626),o=(n(9231),n(4852));const a={sidebar_position:4},i="React",s={unversionedId:"react",id:"react",title:"React",description:"lo-fi has React hooks generation. To enable it, pass --react to the CLI. A new module react.js will be emitted in the output directory. It exports one function, createHooks. Pass your ClientDescriptor instance into that.",source:"@site/docs/react.md",sourceDirName:".",slug:"/react",permalink:"/docs/react",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/react.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Advanced: Transports",permalink:"/docs/sync/transports"}},l={},c=[{value:"Suspense",id:"suspense",level:2},{value:"Usage example",id:"usage-example",level:2}],p={toc:c};function u(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"react"},"React"),(0,o.kt)("p",null,"lo-fi has React hooks generation. To enable it, pass ",(0,o.kt)("inlineCode",{parentName:"p"},"--react")," to the ",(0,o.kt)("a",{parentName:"p",href:"./local-storage/generate-client"},"CLI"),". A new module ",(0,o.kt)("inlineCode",{parentName:"p"},"react.js")," will be emitted in the output directory. It exports one function, ",(0,o.kt)("inlineCode",{parentName:"p"},"createHooks"),". Pass your ClientDescriptor instance into that."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"import { ClientDescriptor, ServerSync } from './client/index.js';\nimport { createHooks } from './client/react.js';\nimport schema from './schema.js';\nimport migrations from './migrations.js';\n\nconst clientDesc = new ClientDescriptor({\n    namespace: 'todos',\n    schema,\n    migrations,\n    sync: new ServerSync({\n        host: 'https://your.server/lofi',\n    }),\n    initialPresence: {\n        emoji: '',\n    },\n});\n\nconst hooks = createHooks(clientDesc);\n")),(0,o.kt)("p",null,"It will generate named hooks based on each document collection, plus a few utility hooks. For example, if you have the collection ",(0,o.kt)("inlineCode",{parentName:"p"},"todoItems"),", you will get these hooks:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"useAllTodoItems"),": pass an index query to filter the list of returned items."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"useOneTodoItem"),": pass an index query to filter the list of returned items, and only take the first match."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"useTodoItem"),": Retrieves one document. You pass in an id."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"useWatch"),': pass a "live document" to this and the component will update when that document changes. An unfortunate necessity of the WIP reactive object approach.'),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"useSelf"),": returns your own presence."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"usePeerIds"),": returns an array of string user IDs of peers. Good for iterating over peers to render them."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"usePeer"),": pass a peer's user ID to retrieve their presence."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"useSyncStatus"),": returns a boolean indicating whether sync is active or not.")),(0,o.kt)("p",null,"As you can see from some of that, React hooks are pretty WIP still."),(0,o.kt)("h2",{id:"suspense"},"Suspense"),(0,o.kt)("p",null,"The hooks use Suspense so that you don't have to write loading state conditional code in your components. All hooks return data directly. If the data is not ready, they suspend."),(0,o.kt)("p",null,"Wrap your app in a ",(0,o.kt)("inlineCode",{parentName:"p"},"<Suspense>")," to handle this. You can create multiple layers of Suspense to handle loading more granularly."),(0,o.kt)("h2",{id:"usage-example"},"Usage example"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"function Todos() {\n    const items = hooks.useAllTodoItems({\n        index: {\n            where: 'indexableDone',\n            equals: 'false',\n        },\n    });\n\n    return (\n        <ul>\n            {items.map((item) => (\n                <li key={item.get('id')}>{item.get('content')}</li>\n            ))}\n        </ul>\n    );\n}\n")))}u.isMDXComponent=!0}}]);